# 非エンジニア向け運用ガイド 🎯

## あなたのタスク一覧

### 📝 今すぐやること（初回デプロイ）

#### ステップ1: AWS Amplifyでアプリを公開（15分）

1. **AWSにログイン**
   - https://console.aws.amazon.com/ にアクセス
   - あなたのAWSアカウントでログイン

2. **Amplifyを開く**
   - 検索バーに「Amplify」と入力
   - 「AWS Amplify」をクリック

3. **新しいアプリを作成**
   - 「新しいアプリ」ボタンをクリック
   - 「Webアプリをホスト」を選択
   - 「GitHub」を選択して認証

4. **リポジトリを選択**
   - リポジトリ: `company-search-system`
   - ブランチ: `main`
   - 「次へ」をクリック

5. **ビルド設定**
   - 「モノレポ？」と聞かれたら「はい」を選択
   - アプリのルート: `video-nfc-admin` と入力
   - `amplify.yml`が自動検出されます
   - 「次へ」をクリック

6. **環境変数を設定**（重要！）
   - 「環境変数を追加」をクリック
   - 以下を1つずつ入力：

   ```
   キー: NEXT_PUBLIC_COGNITO_USER_POOL_ID
   値: ap-northeast-1_gtvMJ70ot

   キー: NEXT_PUBLIC_COGNITO_USER_POOL_CLIENT_ID
   値: 6o0knadh7s8v164r6a8kvp7m0n

   キー: NEXT_PUBLIC_COGNITO_REGION
   値: ap-northeast-1

   キー: NEXT_PUBLIC_API_BASE_URL
   値: https://ujwli7k2ti.execute-api.ap-northeast-1.amazonaws.com/dev

   キー: NEXT_PUBLIC_APP_ENV
   値: production

   キー: NODE_ENV
   値: production
   ```

7. **デプロイ開始**
   - 「保存してデプロイ」をクリック
   - 5-10分待つ（コーヒーブレイク☕️）
   - 完了すると緑色のチェックマークが表示されます

8. **URLを確認**
   - 画面上部に表示されるURL（例: `https://main.xxxxx.amplifyapp.com`）
   - このURLをブラウザで開いて動作確認

---

### 🔄 日常的にやること（機能追加・更新時）

#### パターンA: エンジニアが更新した場合（自動）

**何もしなくてOK！**
- エンジニアがGitHubにコードをアップロード（push）
- → 自動的にAmplifyが検知
- → 自動的にビルド＆デプロイ
- → 5-10分後に本番サイトに反映

**確認方法**:
1. Amplifyコンソールを開く
2. 「最近のビルド」に新しい行が表示される
3. ステータスが「成功」になったら完了

---

#### パターンB: あなたが内容を変更したい場合

##### 例1: テキストやデザインの変更

1. **GitHubでファイルを開く**
   - https://github.com/advalay/company-search-system にアクセス
   - `video-nfc-admin/app/` フォルダに移動
   - 変更したいファイルをクリック

2. **編集する**
   - 鉛筆アイコン（編集）をクリック
   - テキストを変更
   - 「変更をコミット」ボタンをクリック

3. **自動デプロイ待ち**
   - 5-10分待つ
   - サイトを更新して確認

##### 例2: 画像の変更

1. **GitHubで画像をアップロード**
   - `video-nfc-admin/public/images/` フォルダに移動
   - 「ファイルを追加」→「ファイルをアップロード」
   - 画像をドラッグ＆ドロップ
   - 「変更をコミット」ボタンをクリック

2. **自動デプロイ待ち**
   - 5-10分待つ
   - サイトに新しい画像が表示される

---

### 🚨 トラブルシューティング

#### デプロイが失敗した場合

1. **Amplifyコンソールで確認**
   - 「ビルドの詳細」をクリック
   - 赤い文字のエラーメッセージをコピー

2. **ロールバック（前の状態に戻す）**
   - Amplifyコンソールで「ビルド履歴」タブをクリック
   - 成功した前のビルドを選択
   - 「再デプロイ」をクリック

3. **エンジニアに連絡**
   - エラーメッセージを共有
   - どんな変更をしたか伝える

#### サイトが表示されない場合

1. **ブラウザのキャッシュをクリア**
   - Chrome: `Cmd + Shift + R` (Mac) / `Ctrl + Shift + R` (Windows)

2. **別のブラウザで試す**
   - Safari、Firefoxなど

3. **Amplifyのステータス確認**
   - Amplifyコンソールでアプリのステータスが「実行中」になっているか確認

---

## 🛠️ 更新しやすい環境設定（完了済み✅）

### すでに設定されています！

#### 1. **自動デプロイ（CI/CD）** ✅
- GitHubにコードをアップロード → 自動で本番サイトに反映
- 手動でサーバー操作は不要

#### 2. **ロールバック機能** ✅
- 問題があれば1クリックで前の状態に戻せる
- データは失われません

#### 3. **プレビュー環境** ✅（推奨設定）
- テスト用のURLを作成可能
- 本番サイトに影響なく試せる

**プレビュー環境の作り方**:
1. Amplifyコンソールで「ブランチを追加」
2. `develop`ブランチを選択
3. これで `https://develop.xxxxx.amplifyapp.com` が作成される
4. ここでテストしてから本番（`main`）に反映

---

## 📊 日常的な確認事項

### 毎日チェック（1分）

1. **サイトが動いているか確認**
   - URLを開いてログインできるか

### 週次チェック（5分）

1. **Amplifyコンソールでエラー確認**
   - https://console.aws.amazon.com/amplify/
   - 「モニタリング」タブでエラー数を確認

2. **AWSコスト確認**
   - https://console.aws.amazon.com/cost-management/
   - 今月の使用料を確認（予算: 約$50-100/月）

### 月次チェック（10分）

1. **ユーザー数確認**
   - Amplifyの「アナリティクス」タブで確認

2. **バックアップ確認**
   - DynamoDBのバックアップが取れているか確認

---

## 🎓 覚えておくと便利な用語

| 用語 | 意味 | 例 |
|------|------|-----|
| **デプロイ** | サイトを公開すること | コードをアップロードして本番サイトに反映 |
| **ビルド** | コードを本番用に変換すること | Amplifyが自動でやってくれる |
| **ロールバック** | 前の状態に戻すこと | 問題があったら1つ前のバージョンに戻す |
| **CI/CD** | 自動デプロイの仕組み | GitHubにアップロード→自動で反映 |
| **環境変数** | サイトの設定情報 | APIのURLやCognitoの設定など |

---

## 📞 困ったときの連絡先

### エンジニアに連絡が必要なケース

- ❌ デプロイが3回連続で失敗した
- ❌ サイトが30分以上ダウンしている
- ❌ 新しい機能を追加したい
- ❌ AWSの請求が予想より高い（$150以上）
- ❌ セキュリティの警告が表示された

### 自分で対応できるケース

- ✅ テキストの修正（GitHubで編集）
- ✅ 画像の差し替え（GitHubでアップロード）
- ✅ 一時的なエラー（ロールバックで対応）
- ✅ デプロイの進捗確認（Amplifyコンソールで確認）

---

## 🎯 今後の改善タスク（優先順位順）

### 優先度：高 🔴

1. **カスタムドメインの設定**（30分）
   - 例: `video-nfc.your-company.com`
   - Amplifyコンソールの「ドメイン管理」から設定

2. **アラート設定**（15分）
   - エラーが発生したらメール通知
   - CloudWatchアラームで設定

### 優先度：中 🟡

3. **バックアップ自動化**（設定済み、確認のみ）
   - DynamoDBの自動バックアップ確認

4. **プレビュー環境作成**（10分）
   - テスト用URLの作成

### 優先度：低 🟢

5. **モニタリングダッシュボード**（30分）
   - アクセス数、エラー数を一目で確認

6. **コスト最適化**（継続的）
   - 不要なリソースの削減

---

## ✅ チェックリスト（印刷して使ってください）

### 初回デプロイ
- [ ] AWSにログインできた
- [ ] Amplifyでアプリを作成した
- [ ] GitHubリポジトリを接続した
- [ ] 環境変数を6つ全て設定した
- [ ] デプロイが成功した（緑のチェックマーク）
- [ ] URLでサイトが開けた
- [ ] ログインできた

### 日常運用
- [ ] 毎日：サイトが動いているか確認
- [ ] 毎週：Amplifyでエラー確認
- [ ] 毎週：AWSコスト確認
- [ ] 毎月：ユーザー数確認
- [ ] 毎月：バックアップ確認

### 更新時
- [ ] GitHubで変更をコミット
- [ ] Amplifyで自動デプロイ開始を確認
- [ ] 5-10分待つ
- [ ] デプロイ成功を確認
- [ ] サイトで動作確認

---

## 📚 参考リンク

- **AWS Amplifyコンソール**: https://console.aws.amazon.com/amplify/
- **GitHubリポジトリ**: https://github.com/advalay/company-search-system
- **AWS料金計算ツール**: https://calculator.aws/
- **Amplify公式ドキュメント**: https://docs.amplify.aws/

---

**このガイドを印刷して、デスクに置いておくことをおすすめします！** 📖✨

